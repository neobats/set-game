// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Stdlib_List from "@rescript/runtime/lib/es6/Stdlib_List.js";

function init() {
  return /* [] */0;
}

let ListCollection = {
  length: Stdlib_List.length,
  add: Stdlib_List.add,
  map: Stdlib_List.map,
  toArray: Stdlib_List.toArray,
  init: init
};

function MakeGameSet(C) {
  return Collection => {
    let inspect = (cards, messageOpt) => {
      let message = messageOpt !== undefined ? messageOpt : "Cards";
      console.log(message, cards);
      return cards;
    };
    let maybeSet = cards => {
      let match = Collection.length(cards);
      if (match !== 0) {
        if (match !== 3) {
          return {
            TAG: "Filling",
            _0: cards
          };
        } else {
          return {
            TAG: "Filled",
            _0: cards
          };
        }
      } else {
        return "Empty";
      }
    };
    let add = (cards, card) => {
      let match = Collection.length(cards);
      if (match !== 3) {
        return Collection.add(cards, card);
      } else {
        return cards;
      }
    };
    let toSet = (s, _l) => {
      while (true) {
        let l = _l;
        if (l === 0) {
          return s;
        }
        s.add(l.hd);
        _l = l.tl;
        continue;
      };
    };
    let checkProperty = (getProperty, cards) => {
      let values = toSet(new Set(), Stdlib_List.map(cards, getProperty));
      let match = values.size;
      if (match !== 1 && match !== 3) {
        return "Invalid";
      } else {
        return "Valid";
      }
    };
    let checkShapes = extra => checkProperty(card => card.shape, extra);
    let checkColors = extra => checkProperty(card => card.color, extra);
    let checkFills = extra => checkProperty(card => card.fill, extra);
    let checkNumbers = extra => checkProperty(card => card.number, extra);
    return {
      length: Collection.length,
      map: Collection.map,
      toArray: Collection.toArray,
      make: Collection.init,
      inspect: inspect,
      maybeSet: maybeSet,
      add: add,
      toSet: toSet,
      checkProperty: checkProperty,
      checkShapes: checkShapes,
      checkColors: checkColors,
      checkFills: checkFills,
      checkNumbers: checkNumbers
    };
  };
}

function inspect(cards, messageOpt) {
  let message = messageOpt !== undefined ? messageOpt : "Cards";
  console.log(message, cards);
  return cards;
}

function maybeSet(cards) {
  let match = Stdlib_List.length(cards);
  if (match !== 0) {
    if (match !== 3) {
      return {
        TAG: "Filling",
        _0: cards
      };
    } else {
      return {
        TAG: "Filled",
        _0: cards
      };
    }
  } else {
    return "Empty";
  }
}

function add(cards, card) {
  let match = Stdlib_List.length(cards);
  if (match !== 3) {
    return Stdlib_List.add(cards, card);
  } else {
    return cards;
  }
}

function toSet(s, _l) {
  while (true) {
    let l = _l;
    if (l === 0) {
      return s;
    }
    s.add(l.hd);
    _l = l.tl;
    continue;
  };
}

function checkProperty(getProperty, cards) {
  let values = toSet(new Set(), Stdlib_List.map(cards, getProperty));
  let match = values.size;
  if (match !== 1 && match !== 3) {
    return "Invalid";
  } else {
    return "Valid";
  }
}

function checkShapes(extra) {
  return checkProperty(card => card.shape, extra);
}

function checkColors(extra) {
  return checkProperty(card => card.color, extra);
}

function checkFills(extra) {
  return checkProperty(card => card.fill, extra);
}

function checkNumbers(extra) {
  return checkProperty(card => card.number, extra);
}

let GameSet = {
  length: Stdlib_List.length,
  map: Stdlib_List.map,
  toArray: Stdlib_List.toArray,
  make: init,
  inspect: inspect,
  maybeSet: maybeSet,
  add: add,
  toSet: toSet,
  checkProperty: checkProperty,
  checkShapes: checkShapes,
  checkColors: checkColors,
  checkFills: checkFills,
  checkNumbers: checkNumbers
};

export {
  ListCollection,
  MakeGameSet,
  GameSet,
}
/* No side effect */
